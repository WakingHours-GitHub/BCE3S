Configuration: project_name=main_cifar100_stage2, imbalance_factor=0.01, num_classes=100, embedding_dim=512, encoder=ResNet34, batch_size=64
Python version: 3.9.19 (main, May  6 2024, 19:43:03) 
[GCC 11.2.0]
PyTorch version: 1.13.1+cu117
Random seed: 0
Files already downloaded and verified
Training set examples: 10847
Test set examples: 10000
Train batches: 170, Test batches: 157
Loaded stage 1 model and classifier
Stage 1 model performance:
acc avgClass:  55.43%
Many: 82.86% Medium: 56.09% Few: 22.67%
Training for 10 epochs
Class_Balanced_Loss_with_normalize_weight(in_features=512, out_features=100, img_num_per_cls=[500, 477, 455, 434, 415, 396, 378, 361, 344, 328, 314, 299, 286, 273, 260, 248, 237, 226, 216, 206, 197, 188, 179, 171, 163, 156, 149, 142, 135, 129, 123, 118, 112, 107, 102, 98, 93, 89, 85, 81, 77, 74, 70, 67, 64, 61, 58, 56, 53, 51, 48, 46, 44, 42, 40, 38, 36, 35, 33, 32, 30, 29, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 15, 14, 13, 13, 12, 12, 11, 11, 10, 10, 9, 9, 8, 8, 7, 7, 7, 6, 6, 6, 6, 5, 5, 5, 5], nClasses=100, mode=bce, beta=0.99999, gamma=2.0, r=0.4)

Epoch 1/10
----------
train
	loss:0.147579, acc-all:0.95566, acc-avg-cls:0.86017 | lr: 9.755282581475769e-05
test
	loss:2.189988, acc-all:0.57680, acc-avg-cls:0.57680 | lr: 9.755282581475769e-05

Epoch 2/10
----------
train
	loss:0.119272, acc-all:0.95704, acc-avg-cls:0.90686 | lr: 9.045084971874737e-05
test
	loss:2.127435, acc-all:0.57570, acc-avg-cls:0.57570 | lr: 9.045084971874737e-05

Epoch 3/10
----------
train
	loss:0.117900, acc-all:0.95307, acc-avg-cls:0.89932 | lr: 7.938926261462366e-05
test
	loss:2.018956, acc-all:0.58320, acc-avg-cls:0.58320 | lr: 7.938926261462366e-05

Epoch 4/10
----------
train
	loss:0.124412, acc-all:0.95178, acc-avg-cls:0.89482 | lr: 6.545084971874737e-05
test
	loss:2.185655, acc-all:0.57360, acc-avg-cls:0.57360 | lr: 6.545084971874737e-05

Epoch 5/10
----------
train
	loss:0.121978, acc-all:0.94717, acc-avg-cls:0.88857 | lr: 4.9999999999999996e-05
test
	loss:2.091216, acc-all:0.57500, acc-avg-cls:0.57500 | lr: 4.9999999999999996e-05

Epoch 6/10
----------
train
	loss:0.121581, acc-all:0.94551, acc-avg-cls:0.91431 | lr: 3.454915028125263e-05
test
	loss:1.973335, acc-all:0.57700, acc-avg-cls:0.57700 | lr: 3.454915028125263e-05

Epoch 7/10
----------
train
	loss:0.118561, acc-all:0.95538, acc-avg-cls:0.90823 | lr: 2.0610737385376345e-05
test
	loss:2.028296, acc-all:0.57710, acc-avg-cls:0.57710 | lr: 2.0610737385376345e-05

Epoch 8/10
----------
train
	loss:0.120001, acc-all:0.95271, acc-avg-cls:0.89814 | lr: 9.549150281252631e-06
test
	loss:2.080949, acc-all:0.58010, acc-avg-cls:0.58010 | lr: 9.549150281252631e-06

Epoch 9/10
----------
train
	loss:0.116271, acc-all:0.95446, acc-avg-cls:0.90551 | lr: 2.447174185242323e-06
test
	loss:2.043452, acc-all:0.57410, acc-avg-cls:0.57410 | lr: 2.447174185242323e-06

Epoch 10/10
----------
train
	loss:0.118532, acc-all:0.95123, acc-avg-cls:0.90705 | lr: 0.0
test
	loss:2.073302, acc-all:0.57750, acc-avg-cls:0.57750 | lr: 0.0
Training complete in 0m 44s
Final model performance:
acc avgClass:  59.20%
Many: 77.37% Medium: 55.03% Few: 42.87%
Results saved to: runs/main_cifar100_stage2
