Configuration: project_name=exp_20251111_094017, imbalance_factor=0.01, num_classes=100, embedding_dim=512, encoder=ResNet34, batch_size=64
Python version: 3.9.19 (main, May  6 2024, 19:43:03) 
[GCC 11.2.0]
PyTorch version: 1.13.1+cu117
Random seed: 0
Files already downloaded and verified
Training set examples: 10847
Test set examples: 10000
Train batches: 170, Test batches: 157
Training for 320 epochs
BCE_TripartiteSynergisticLearning(in_features=512, out_features=100, temperature=1.0, projection_dim=128, strict=64, r=0.4, l=1.0, ss_weight=0.1, cc_s=1.0, cc_weight=1.0, eps=1e-05)

Epoch 1/320
----------
train
	loss:76.849064, acc-all:0.05485, acc-avg-cls:0.01663 | lr: 0.00999975904479664
test
	loss:5.923563, acc-all:0.04190, acc-avg-cls:0.04190 | lr: 0.00999975904479664

Epoch 11/320
----------
train
	loss:99.682605, acc-all:0.24265, acc-avg-cls:0.08742 | lr: 0.00997087251058714
test
	loss:5.698473, acc-all:0.10420, acc-avg-cls:0.10420 | lr: 0.00997087251058714

Epoch 21/320
----------
train
	loss:99.258660, acc-all:0.36001, acc-avg-cls:0.14985 | lr: 0.009894113756745362
test
	loss:5.334977, acc-all:0.17540, acc-avg-cls:0.17540 | lr: 0.009894113756745362

Epoch 31/320
----------
train
	loss:98.819037, acc-all:0.45662, acc-avg-cls:0.21252 | lr: 0.009770222012031406
test
	loss:5.383472, acc-all:0.23400, acc-avg-cls:0.23400 | lr: 0.009770222012031406

Epoch 41/320
----------
train
	loss:98.645718, acc-all:0.49765, acc-avg-cls:0.25156 | lr: 0.00960039042167298
test
	loss:5.225900, acc-all:0.26550, acc-avg-cls:0.26550 | lr: 0.00960039042167298

Epoch 51/320
----------
train
	loss:98.525090, acc-all:0.51904, acc-avg-cls:0.27033 | lr: 0.009386254556724628
test
	loss:4.699178, acc-all:0.28180, acc-avg-cls:0.28180 | lr: 0.009386254556724628

Epoch 61/320
----------
train
	loss:98.442844, acc-all:0.55213, acc-avg-cls:0.29749 | lr: 0.009129876662624372
test
	loss:4.795448, acc-all:0.32240, acc-avg-cls:0.32240 | lr: 0.009129876662624372

Epoch 71/320
----------
train
	loss:98.337945, acc-all:0.57426, acc-avg-cls:0.31930 | lr: 0.00883372579864281
test
	loss:4.477597, acc-all:0.34450, acc-avg-cls:0.34450 | lr: 0.00883372579864281

Epoch 81/320
----------
train
	loss:98.123666, acc-all:0.57564, acc-avg-cls:0.32189 | lr: 0.00850065405949262
test
	loss:4.762729, acc-all:0.30960, acc-avg-cls:0.30960 | lr: 0.00850065405949262

Epoch 91/320
----------
train
	loss:98.253977, acc-all:0.59758, acc-avg-cls:0.34046 | lr: 0.00813386910809735
test
	loss:4.657315, acc-all:0.32010, acc-avg-cls:0.32010 | lr: 0.00813386910809735

Epoch 101/320
----------
train
	loss:98.151362, acc-all:0.62275, acc-avg-cls:0.36410 | lr: 0.007736903284043986
test
	loss:4.602957, acc-all:0.30390, acc-avg-cls:0.30390 | lr: 0.007736903284043986

Epoch 111/320
----------
train
	loss:98.131047, acc-all:0.63575, acc-avg-cls:0.37672 | lr: 0.007313579585221754
test
	loss:4.501030, acc-all:0.36440, acc-avg-cls:0.36440 | lr: 0.007313579585221754

Epoch 121/320
----------
train
	loss:98.078876, acc-all:0.65179, acc-avg-cls:0.39159 | lr: 0.006867974850262584
test
	loss:4.301075, acc-all:0.37510, acc-avg-cls:0.37510 | lr: 0.006867974850262584

Epoch 131/320
----------
train
	loss:98.001587, acc-all:0.67014, acc-avg-cls:0.41200 | lr: 0.006404380496356464
test
	loss:4.640921, acc-all:0.38340, acc-avg-cls:0.38340 | lr: 0.006404380496356464

Epoch 141/320
----------
train
	loss:97.996129, acc-all:0.68341, acc-avg-cls:0.42485 | lr: 0.005927261190557959
test
	loss:4.187016, acc-all:0.39350, acc-avg-cls:0.39350 | lr: 0.005927261190557959

Epoch 151/320
----------
train
	loss:97.884805, acc-all:0.70195, acc-avg-cls:0.44817 | lr: 0.005441211852601853
test
	loss:4.910960, acc-all:0.41920, acc-avg-cls:0.41920 | lr: 0.005441211852601853

Epoch 161/320
----------
train
	loss:97.787769, acc-all:0.71310, acc-avg-cls:0.45434 | lr: 0.0049509134033142565
test
	loss:4.491834, acc-all:0.43670, acc-avg-cls:0.43670 | lr: 0.0049509134033142565

Epoch 171/320
----------
train
	loss:97.631932, acc-all:0.73458, acc-avg-cls:0.48195 | lr: 0.004461087684786206
test
	loss:4.030009, acc-all:0.41940, acc-avg-cls:0.41940 | lr: 0.004461087684786206

Epoch 181/320
----------
train
	loss:97.669161, acc-all:0.74859, acc-avg-cls:0.50478 | lr: 0.003976451986453103
test
	loss:4.342125, acc-all:0.40160, acc-avg-cls:0.40160 | lr: 0.003976451986453103

Epoch 191/320
----------
train
	loss:97.562169, acc-all:0.77542, acc-avg-cls:0.53866 | lr: 0.0035016736150187185
test
	loss:4.186887, acc-all:0.45370, acc-avg-cls:0.45370 | lr: 0.0035016736150187185

Epoch 201/320
----------
train
	loss:97.391585, acc-all:0.79930, acc-avg-cls:0.56413 | lr: 0.0030413249457402207
test
	loss:4.417075, acc-all:0.46550, acc-avg-cls:0.46550 | lr: 0.0030413249457402207

Epoch 211/320
----------
train
	loss:97.349957, acc-all:0.82327, acc-avg-cls:0.60217 | lr: 0.002599839387954945
test
	loss:3.775558, acc-all:0.48010, acc-avg-cls:0.48010 | lr: 0.002599839387954945

Epoch 221/320
----------
train
	loss:97.245443, acc-all:0.82281, acc-avg-cls:0.59944 | lr: 0.002181468688924917
test
	loss:4.298618, acc-all:0.47520, acc-avg-cls:0.47520 | lr: 0.002181468688924917

Epoch 231/320
----------
train
	loss:97.145534, acc-all:0.85895, acc-avg-cls:0.65098 | lr: 0.0017902419871864861
test
	loss:3.926042, acc-all:0.47800, acc-avg-cls:0.47800 | lr: 0.0017902419871864861

Epoch 241/320
----------
train
	loss:97.034370, acc-all:0.88024, acc-avg-cls:0.69417 | lr: 0.00142992700974366
test
	loss:4.008232, acc-all:0.49500, acc-avg-cls:0.49500 | lr: 0.00142992700974366

Epoch 251/320
----------
train
	loss:96.963761, acc-all:0.89481, acc-avg-cls:0.72245 | lr: 0.0011039937867974173
test
	loss:3.672244, acc-all:0.50480, acc-avg-cls:0.50480 | lr: 0.0011039937867974173

Epoch 261/320
----------
train
	loss:96.860975, acc-all:0.91684, acc-avg-cls:0.77613 | lr: 0.0008155812334579549
test
	loss:3.712548, acc-all:0.51370, acc-avg-cls:0.51370 | lr: 0.0008155812334579549

Epoch 271/320
----------
train
	loss:96.717073, acc-all:0.92920, acc-avg-cls:0.79981 | lr: 0.0005674669202762687
test
	loss:3.719119, acc-all:0.52380, acc-avg-cls:0.52380 | lr: 0.0005674669202762687

Epoch 281/320
----------
train
	loss:96.675941, acc-all:0.94008, acc-avg-cls:0.83242 | lr: 0.00036204032372138
test
	loss:3.751375, acc-all:0.53190, acc-avg-cls:0.53190 | lr: 0.00036204032372138

Epoch 291/320
----------
train
	loss:96.555861, acc-all:0.95031, acc-avg-cls:0.86120 | lr: 0.00020127981421571366
test
	loss:3.650767, acc-all:0.53960, acc-avg-cls:0.53960 | lr: 0.00020127981421571366

Epoch 301/320
----------
train
	loss:96.517780, acc-all:0.95556, acc-avg-cls:0.86662 | lr: 8.673360334644173e-05
test
	loss:3.565236, acc-all:0.54280, acc-avg-cls:0.54280 | lr: 8.673360334644173e-05

Epoch 311/320
----------
train
	loss:96.456614, acc-all:0.95483, acc-avg-cls:0.86141 | lr: 1.950483374156433e-05
test
	loss:3.580488, acc-all:0.55130, acc-avg-cls:0.55130 | lr: 1.950483374156433e-05
Training complete in 90m 1s
acc avgClass:  55.81%
Many: 83.11% Medium: 56.51% Few: 23.13%
Results saved to: runs/main_cifar100_stage1/exp_20251111_094017
